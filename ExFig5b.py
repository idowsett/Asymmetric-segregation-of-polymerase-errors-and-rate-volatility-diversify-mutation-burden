import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats

division = [10541044,10541044,10541044,10541044,10541044,10541044,
10636360,10636360,10636360,10636360,10636360,10636360,
9521963,9521963,9521963,9521963,9521963,9521963,9521963,9521963,9521963,9521963,
10594546,10594546,10594546,10594546,10594546,10594546,
9818623,9818623,9818623,9818623,9818623,
9679326,9679326,9679326,9679326,9679326,
8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576]

mutations = [248	,200,	255	,328,	288,	278,
284 ,228,	256	,251,	262,	301,
253	,288,	297	,270,	278,	315	,306,	356,	307,	306,
269	,288,	250	,303,	155,	334,
229	,235,	298	,302,	283,
323,	312	,288,	288,	332,
252	,283,	319	,298,	281,	254,	224,	252,	263,	280,	232,	219]
print(len(division))
print(len(mutations))
dictionary = {
"L_151": 2
,"L_151" : 3
,"L_151" : 4
,"L_151" : 6
,"L_151" : 7
,"L_151" : 8
,"L_153" : 10
,"L_153" : 11
,"L_153" : 12
,"L_153" : 13
,"L_153" : 14
,"L_153" : 15
,"L_156" : 2
,"L_156" : 3
,"L_156" : 4
,"L_156" : 5
,"L_156" : 6
,"L_156" : 7
,"L_156" : 8
,"L_156" : 10
,"L_156" : 11
,"L_156" : 12
,"L_157" : 2
,"L_157" : 3
,"L_157" : 4
,"L_157" : 5
,"L_157" : 6
,"L_157" : 7
,"L_158" : 2
,"L_158" : 3
,"L_158" : 5
,"L_158" : 6
,"L_158" : 8
,"L_160" : 3
,"L_160" : 4
,"L_160" : 6
,"L_160" : 8
,"L_160" : 10
,"L_162" : 2
,"L_162" : 3
,"L_162" : 4
,"L_162" : 5
,"L_162" : 7
,"L_162" : 8
,"L_162" : 11
,"L_162" : 12
,"L_162" : 13
,"L_162" : 14
,"L_162" : 15
,"L_162" : 16}


data = {'scoredsites':[10541044,10541044,10541044,10541044,10541044,10541044,
10636360,10636360,10636360,10636360,10636360,10636360,
9521963,9521963,9521963,9521963,9521963,9521963,9521963,9521963,9521963,9521963,
10594546,10594546,10594546,10594546,10594546,10594546,
9818623,9818623,9818623,9818623,9818623,
9679326,9679326,9679326,9679326,9679326,
8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576,8578576],
'mutations':
[248	,200,	255	,328,	288,	278,
284 ,228,	256	,251,	262,	301,
253	,288,	297	,270,	278,	315	,306,	356,	307,	306,
269	,288,	250	,303,	155,	334,
229	,235,	298	,302,	283,
323,	312	,288,	288,	332,
252	,283,	319	,298,	281,	254,	224,	252,	263,	280,	232,	219]}


import pandas as pd
df = pd.DataFrame(data, columns = ['scoredsites','mutations'])

spearman_coef, ps_value = stats.spearmanr(df["scoredsites"], df["mutations"])
print("Spearman Correlation Coefficient: ", spearman_coef, "and a P-value of:", ps_value)
Title = "Number of Scored Sites and Mutations Correlation"
stats = "r = " + str(round(spearman_coef,5)) + "\np = " + str(round(ps_value, 3))

plt.ticklabel_format(style='sci', axis='x', scilimits=(0,0))
sns.set(style="white", palette="bright", color_codes=True, rc={"lines.linewidth": 1.0})
ax = sns.scatterplot(x='scoredsites', y='mutations', data=df)
plt.xlabel('Scored Sites ( * 1e7)',fontsize=11)
plt.ylabel('Mutations', fontsize=11)
ax.get_xaxis().get_offset_text().set_position((0.1,0))
plt.title(Title)
plt.text(8528576, 150, stats, fontsize=12)

plt.savefig(f"ScoredSiteCorrelation.pdf",transparent = False,bbox_inches='tight')
plt.show()
